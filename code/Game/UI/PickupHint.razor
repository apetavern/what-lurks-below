@using System
@using System.Collections.Generic
@using System.Linq
@using BrickJam.Player
@using Sandbox;
@using Sandbox.UI;
@inherits PanelComponent

<root>
    <InputGlyph button="Use" size="small" />
    Pick up
</root>

<style>
    PickupHint {
        position: absolute;
        font-family: Poppins;
        font-size: 32px;
        font-weight: bold;
        color: white;
        flex-direction: column;
        align-items: center;
        text-shadow: 0px 0px 5px black;
        opacity: 1;
        transition: all 0.5s ease;
        
        &.hidden {
            opacity: 0;
        }
    }
</style>

@code
{
    public TimeSince TimeSincePlayerInRange { get; set; }
    private GameObject PickupTarget { get; set; }
    private GameObject Player { get; set; }

    public override void Update()
    {
        base.Update();

        if (Player is null)
            return;

        Panel.SetClass("hidden", TimeSincePlayerInRange > 1);
    }

    public override void OnStart()
    {
        base.OnStart();

        Player = Scene.GetAllObjects(true).FirstOrDefault(p => p.Name == "player");

        if (GetComponent<IRootPanelComponent>(true) is not WorldPanel worldPanel)
            return;

        worldPanel.Position = Transform.Position + Vector3.Up * 38f;
    }
}
